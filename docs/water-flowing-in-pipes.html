<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Water Flowing in Pipes | Hydraulics and Water Resources: Examples Using R</title>
  <meta name="description" content="<p>A compilation of fluid mechanics, hydraulics, and water resources
engineering exercises using R.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Water Flowing in Pipes | Hydraulics and Water Resources: Examples Using R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/david-becker-rrfdqjJWwmU-unsplash.jpg" />
  <meta property="og:description" content="<p>A compilation of fluid mechanics, hydraulics, and water resources
engineering exercises using R.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Water Flowing in Pipes | Hydraulics and Water Resources: Examples Using R" />
  
  <meta name="twitter:description" content="<p>A compilation of fluid mechanics, hydraulics, and water resources
engineering exercises using R.</p>" />
  <meta name="twitter:image" content="/images/david-becker-rrfdqjJWwmU-unsplash.jpg" />

<meta name="author" content="Ed Maurer" />


<meta name="date" content="2022-10-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="properties-of-water.html"/>
<link rel="next" href="flow-in-open-channels.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydraulics and Water Resources: Examples Using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like <span>https://bookdown.org/yihui/bookdown</span></a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyight"><i class="fa fa-check"></i>Copyight</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="units-in-fluid-mechanics.html"><a href="units-in-fluid-mechanics.html"><i class="fa fa-check"></i><b>2</b> Units in Fluid Mechanics</a></li>
<li class="chapter" data-level="3" data-path="properties-of-water.html"><a href="properties-of-water.html"><i class="fa fa-check"></i><b>3</b> Properties of Water</a>
<ul>
<li class="chapter" data-level="3.1" data-path="properties-of-water.html"><a href="properties-of-water.html#properties-important-for-water-standing-still"><i class="fa fa-check"></i><b>3.1</b> Properties important for water standing still</a></li>
<li class="chapter" data-level="3.2" data-path="properties-of-water.html"><a href="properties-of-water.html#properties-important-for-moving-water"><i class="fa fa-check"></i><b>3.2</b> Properties important for moving water</a></li>
<li class="chapter" data-level="3.3" data-path="properties-of-water.html"><a href="properties-of-water.html#atmosperic-properties"><i class="fa fa-check"></i><b>3.3</b> Atmosperic Properties</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html"><i class="fa fa-check"></i><b>4</b> Water Flowing in Pipes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#important-dimensionless-quantity"><i class="fa fa-check"></i><b>4.1</b> Important dimensionless quantity</a></li>
<li class="chapter" data-level="4.2" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#friction-loss-in-circular-pipes"><i class="fa fa-check"></i><b>4.2</b> Friction Loss in Circular Pipes</a></li>
<li class="chapter" data-level="4.3" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-pipe-friction-problems"><i class="fa fa-check"></i><b>4.3</b> Solving Pipe friction problems</a></li>
<li class="chapter" data-level="4.4" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#type1"><i class="fa fa-check"></i><b>4.4</b> Solving for Head Loss (Type 1 problems)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-head-loss-by-manual-iteration"><i class="fa fa-check"></i><b>4.4.1</b> Solving for head loss by manual iteration</a></li>
<li class="chapter" data-level="4.4.2" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#coleb-solver"><i class="fa fa-check"></i><b>4.4.2</b> Solving for head loss using an equation solver</a></li>
<li class="chapter" data-level="4.4.3" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-head-loss-using-an-r-package"><i class="fa fa-check"></i><b>4.4.3</b> Solving for head loss using an R package</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-flow-or-velocity-type-2-problems"><i class="fa fa-check"></i><b>4.5</b> Solving for Flow or Velocity (Type 2 problems)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-q-or-v-using-manual-iteration"><i class="fa fa-check"></i><b>4.5.1</b> Solving for Q (or V) using manual iteration</a></li>
<li class="chapter" data-level="4.5.2" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-q-using-an-explicit-equation"><i class="fa fa-check"></i><b>4.5.2</b> Solving for Q Using an Explicit Equation</a></li>
<li class="chapter" data-level="4.5.3" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-q-using-an-r-package"><i class="fa fa-check"></i><b>4.5.3</b> Solving for Q Using an R package</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-pipe-diameter-d-type-3-problems"><i class="fa fa-check"></i><b>4.6</b> Solving for pipe diameter, D (Type 3 problems)</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-d-using-manual-iterations"><i class="fa fa-check"></i><b>4.6.1</b> Solving for D using manual iterations</a></li>
<li class="chapter" data-level="4.6.2" data-path="water-flowing-in-pipes.html"><a href="water-flowing-in-pipes.html#solving-for-d-using-an-equation-solver"><i class="fa fa-check"></i><b>4.6.2</b> Solving for D using an equation solver</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html"><i class="fa fa-check"></i><b>5</b> Flow in open channels</a>
<ul>
<li class="chapter" data-level="5.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#important-dimensionless-quantity-1"><i class="fa fa-check"></i><b>5.1</b> Important dimensionless quantity</a></li>
<li class="chapter" data-level="5.2" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#an-example-with-uniform-open-channel-flow"><i class="fa fa-check"></i><b>5.2</b> 2.0 An Example with Uniform Open channel Flow</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#using-an-equation-solver-in-r"><i class="fa fa-check"></i><b>5.2.1</b> 2.1 Using an Equation Solver in R</a></li>
<li class="chapter" data-level="5.2.2" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#using-a-pre-built-r-package"><i class="fa fa-check"></i><b>5.2.2</b> 2.2 Using a pre-built R package</a></li>
<li class="chapter" data-level="5.2.3" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#using-a-spreadsheet-like-excel"><i class="fa fa-check"></i><b>5.2.3</b> 2.3 Using a Spreadsheet Like Excel</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#solving-a-system-of-equations"><i class="fa fa-check"></i><b>5.3</b> 3.0 Solving a System of Equations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>6</b> Blocks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>6.1</b> Equations</a></li>
<li class="chapter" data-level="6.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>6.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="6.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>6.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>7</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>7.1</b> Publishing</a></li>
<li class="chapter" data-level="7.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>7.2</b> 404 pages</a></li>
<li class="chapter" data-level="7.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>7.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydraulics and Water Resources: Examples Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="water-flowing-in-pipes" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Water Flowing in Pipes<a href="water-flowing-in-pipes.html#water-flowing-in-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Flow in civil engineering infrastructure is usually either in pipes, where it is not exposed to the atmosphere and flows under pressure, or open channels (canals, rivers, etc.). this chapter is concerned only with water flow in pipes.</p>
<p><img src="images/pressurized-water-pipe.jpg" width="70%" /></p>
<p>Once water begins to move engineering problems often need to relate the flow rate to the energy dissipated. To accomplish this, the flow needs to be classified using dimensionless constants since energy dissipation varies with the flow conditions.</p>
<div id="important-dimensionless-quantity" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Important dimensionless quantity<a href="water-flowing-in-pipes.html#important-dimensionless-quantity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As water begins to move, the characteristics are described by two quantities in engineering hydraulics: the Reynolds number, <em>Re</em> and the Froude number <em>Fr</em>. The latter is more important for open channel flow and will be discussed in that chapter.</p>
<p>Reynolds number describes the turbulence of the flow, defined by the ratio of kinematic forces, expressed by velocity <em>V</em> and a characteristic length such as pipe diameter, <em>D</em>, to viscous forces as expressed by the kinematic viscosity <span class="math inline">\(\nu\)</span>, as in Equation <a href="water-flowing-in-pipes.html#eq:reynolds">(4.1)</a></p>
<p><span class="math display" id="eq:reynolds">\[\begin{equation}
  Re=\frac{VD}{\nu}
  \tag{4.1}
\end{equation}\]</span></p>
<p>For open channels the characteristic length is the <em>hydraulic depth</em>, the area of flow divided by the top width. For adequately turbulent conditions to exists, Reynolds numbers should exceed 4000 for full pipes, and 2000 for open channels.</p>
</div>
<div id="friction-loss-in-circular-pipes" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Friction Loss in Circular Pipes<a href="water-flowing-in-pipes.html#friction-loss-in-circular-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The energy at any point along a pipe containing flowing water is often described by the energy per unit weight, or energy head, E, as in Equation <a href="water-flowing-in-pipes.html#eq:energy1">(4.2)</a></p>
<p><span class="math display" id="eq:energy1">\[\begin{equation}
  E = z+\frac{P}{\gamma}+\alpha\frac{V^2}{2g}
  \tag{4.2}
\end{equation}\]</span>
where <em>P</em> is the pressure, <span class="math inline">\(\gamma=\rho g\)</span> is the specific weight of water, <em>z</em> is the elevation of the point, <em>V</em> is the average velocity, and each term has units of length. <span class="math inline">\(\alpha\)</span> is a kinetic energy adjustment factor to account for non-uniform velocity distribution across the cross-section. <span class="math inline">\(\alpha\)</span> is typically assumed to be 1.0 for turbulent flow in circular pipes because the value is close to 1.0 and <span class="math inline">\(\frac{V^2}{2g}\)</span> (the velocity head) tends to be small in relation to other terms in the equation. Some applications where velocity varies widely across a cross-section, such as a river channel with flow in a main channel and a flood plain, will need to account for values of <span class="math inline">\(\alpha\)</span> other than one.</p>
<p>As water flows through a pipe energy is lost due to friction with the pipe walls and local disturbances (minor losses). The energy loss between two sections is expressed as <span class="math inline">\({E_1} - {h_l} = {E_2}\)</span>. When pipes are long, with <span class="math inline">\(\frac{L}{D}&gt;1000\)</span>, friction losses dominate the energy loss on the system, and the head loss, <span class="math inline">\(h_l\)</span>, is calculated as the head loss due to friction, <span class="math inline">\(h_f\)</span>.</p>
<p>This energy head loss due to friction with the walls of the pipe is described by the Darcy-Weisbach equation, which estimates the energy loss per unit weight, or head loss <span class="math inline">\({h_f}\)</span>, which has units of length. For circular pipes it is expressed by Equation <a href="water-flowing-in-pipes.html#eq:d-w1">(4.3)</a></p>
<p><span class="math display" id="eq:d-w1">\[\begin{equation}
  h_f = \frac{fL}{D}\frac{V^2}{2g} = \frac{8fL}{\pi^{2}gD^{5}}Q^{2}
  \tag{4.3}
\end{equation}\]</span></p>
<p>In equation <a href="water-flowing-in-pipes.html#eq:d-w1">(4.3)</a> <em>f</em> is the friction factor, typically calculated with the Colebrook equation (Equation <a href="water-flowing-in-pipes.html#eq:coleb1">(4.4)</a>).</p>
<p><span class="math display" id="eq:coleb1">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{2.51}{Re\sqrt{f}}\right)
  \tag{4.4}
\end{equation}\]</span></p>
<p>In Equation <a href="water-flowing-in-pipes.html#eq:coleb1">(4.4)</a> <span class="math inline">\(k_s\)</span> is the absolute roughness of the pipe wall. There are close approximations to the Colebrook equation that have an explicit form to facilitate hand-calculations, but when using R or other computational tools there is no need to use approximations.</p>
</div>
<div id="solving-pipe-friction-problems" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Solving Pipe friction problems<a href="water-flowing-in-pipes.html#solving-pipe-friction-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As water flows through a pipe energy is lost due to friction with the pipe walls and local disturbances (minor losses). For this example assume minor losses are negligible. The energy head loss due to friction with the walls of the pipe is described by the Darcy-Weisbach equation (Equation (<a href="water-flowing-in-pipes.html#eq:d-w1">(4.3)</a>)), which estimates the energy loss per unit weight, or head loss h<sub>f</sub>, which has units of length. The Colebrook equation (Equation <a href="water-flowing-in-pipes.html#eq:coleb1">(4.4)</a>) is commonly plotted as a Moody diagram to illustrate the relationships between the variables (Figure <a href="water-flowing-in-pipes.html#fig:moody1">4.1</a>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="water-flowing-in-pipes.html#cb1-1" aria-hidden="true" tabindex="-1"></a>hydraulics<span class="sc">::</span><span class="fu">moody</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:moody1"></span>
<img src="hydr-watres_main_files/figure-html/moody1-1.png" alt="Moody Diagram" width="672" />
<p class="caption">
Figure 4.1: Moody Diagram
</p>
</div>
<p>Because of the for of the equations, they can sometimes be a challenge to solve, especially by hand. It can help to classify the types of problems based on what variable is unknown. these are summarized in Table <a href="#tab:prob-types"><strong>??</strong></a>.</p>
<table>
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Known</th>
<th align="left">Unknown</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Q (or V), D, ks, L</td>
<td align="left">hL</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">hL, D, ks, L</td>
<td align="left">Q (or V)</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">hL, Q (or V), ks, L</td>
<td align="left">D</td>
</tr>
</tbody>
</table>
<p>when solving by hand the types in Table <a href="#tab:prob-types"><strong>??</strong></a> become progressively more difficult, but when using solvers the difference in complexity is subtle.</p>
</div>
<div id="type1" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Solving for Head Loss (Type 1 problems)<a href="water-flowing-in-pipes.html#type1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simplest pipe flow problem to solve is when the unknown is head loss, h<sub>f</sub> (equivalent to h<sub>L</sub> in the absence of minor losses), since all variables on the right side of the Darcy-Weisbach equation are known, except <em>f</em>.</p>
<div id="solving-for-head-loss-by-manual-iteration" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Solving for head loss by manual iteration<a href="water-flowing-in-pipes.html#solving-for-head-loss-by-manual-iteration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While all unknowns are on the right side of Equation (<a href="water-flowing-in-pipes.html#eq:d-w1">(4.3)</a>), iteration is still required because the Colebrook equation (Equation <a href="water-flowing-in-pipes.html#eq:coleb1">(4.4)</a>) cannot be solved explicitly for f.Â An illustration of solving this type of problem is shown in Example @ref(exm:pipe-1.1).</p>
<div class="example">
<p><span id="exm:pipe-1.1" class="example"><strong>(#exm:pipe-1.1) </strong></span>Find the head loss (due to friction) of 20<span class="math inline">\(^\circ\)</span>C water in a pipe with the following characteristics: Q=0.416 m<span class="math inline">\(^3\)</span>/s, L=100m, D=0.5m, k<sub>s</sub>=0.046mm.</p>
</div>
<p>Since the water temperature is known, first find the kinematic viscocity of water, <span class="math inline">\({\nu}\)</span>, since it is needed for the Reynolds number. This can be obtained from a table in a reference or using software. Here we will use the <em>hydraulics</em> R package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="water-flowing-in-pipes.html#cb2-1" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">kvisc</span>(<span class="at">T=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;SI&quot;</span>)</span>
<span id="cb2-2"><a href="water-flowing-in-pipes.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Kinematic viscosity = %.3e m2/s</span><span class="sc">\n</span><span class="st">&quot;</span>, nu))</span>
<span id="cb2-3"><a href="water-flowing-in-pipes.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Kinematic viscosity = 1.023e-06 m2/s</span></span></code></pre></div>
<p>We will need the Reynolds Number to use the Colebrook equation, and that can be calculated since Q is known. This can be accomplished with a calculator, or using other software (R is used here):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="water-flowing-in-pipes.html#cb3-1" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fl">0.416</span></span>
<span id="cb3-2"><a href="water-flowing-in-pipes.html#cb3-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb3-3"><a href="water-flowing-in-pipes.html#cb3-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> (<span class="fl">3.14</span><span class="sc">/</span><span class="dv">4</span>)<span class="sc">*</span>D<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb3-4"><a href="water-flowing-in-pipes.html#cb3-4" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> Q<span class="sc">/</span>A</span>
<span id="cb3-5"><a href="water-flowing-in-pipes.html#cb3-5" aria-hidden="true" tabindex="-1"></a>Re <span class="ot">&lt;-</span> V<span class="sc">*</span>D<span class="sc">/</span>nu</span>
<span id="cb3-6"><a href="water-flowing-in-pipes.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Velocity = %.3f m/s, Re = %.3e</span><span class="sc">\n</span><span class="st">&quot;</span>, V, Re))</span>
<span id="cb3-7"><a href="water-flowing-in-pipes.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Velocity = 2.120 m/s, Re = 1.036e+06</span></span></code></pre></div>
<p>Now the only unknown in the Colebrook equation is <em>f</em>, but unfortunately <em>f</em> appears on both sides of the equation.</p>
<p>To begin the iterative process, a first guess at <em>f</em> is needed. A reasonable value to use is the minimum f value, f<sub>min</sub>, given the known <span class="math inline">\(\frac{k_s}{D}=\frac{0.046}{500}=0.000092=9.2\cdot 10^{-5}\)</span>.
Reading horizontally from the right vertical axis to the left on the Moody diagram provides a value for <span class="math inline">\(f_{min}\approx 0.012\)</span>.</p>
<p>Numerically, it can be seen that <em>f</em> is independent of <em>Re</em> for large values of <em>Re</em>. When <em>Re</em> is large the second term of the Colebrook equation becomes small and the equation approaches Equation <a href="water-flowing-in-pipes.html#eq:coleb-rough">(4.5)</a>.
<span class="math display" id="eq:coleb-rough">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7}\right)
  \tag{4.5}
\end{equation}\]</span>
This independence of <em>f</em> with varying <em>Re</em> values is visible in the Moody Diagram (Figure <a href="water-flowing-in-pipes.html#fig:moody1">4.1</a>) toward the right, where the lines become horizontal.</p>
<p>Using Equation <a href="water-flowing-in-pipes.html#eq:coleb-rough">(4.5)</a> the same value of f<sub>min</sub>=0.012 is obtained, since the colebrook equation defines the Moody diagram.</p>
<p><strong>Iteration 1:</strong> Using f=0.012 the right side of the Colebrook equation is 8.656. the next estimate for <em>f</em> is then obtained by <span class="math inline">\(\frac{1}{\sqrt{f}}=8.656\)</span> so f=0.0133.</p>
<p><strong>Iteration 2:</strong> Using the new value of f=0.0133 in the right side of the Colebrook equation produces 8.677. A new value for <em>f</em> is obtained by <span class="math inline">\(\frac{1}{\sqrt{f}}=8.677\)</span> so f=0.0133. The solution has converged!</p>
<p>Using the new value of <em>f</em>, the value for h<sub>f</sub> is calculated:
<span class="math display">\[h_f = \frac{8fL}{\pi^{2}gD^{5}}Q^{2}=\frac{8(0.0133)(100)}{\pi^{2}(9.81)(0.5)^{5}}(0.416)^{2}=0.061 m\]</span>
### Solving for headloss using an empirical approximation {#dwapprox}</p>
<p>A shortcut that can be used to avoid iterating to find the friction factor is to use an approximation to the Colebrook equation that can be solved explicitly. One example is the Haaland equation <a href="water-flowing-in-pipes.html#eq:haal">(4.6)</a> <span class="citation">(<a href="references.html#ref-haaland_simple_1983" role="doc-biblioref">Haaland 1983</a>)</span>.
<span class="math display" id="eq:haal">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -1.8\log\left(\left(\frac{\frac{k_s}{D}}{3.7}\right)^{1.11}+\frac{6.9}{Re}\right)
  \tag{4.6}
\end{equation}\]</span></p>
<p>For ordinary pipe flow conditions in water pipes, Equation <a href="water-flowing-in-pipes.html#eq:haal">(4.6)</a> is accurate to within 1.5% of the Colebrook equation. There are many other empirical equations, one common one being that of Swamee and Jain <span class="citation">(<a href="references.html#ref-swamee_explicit_1976" role="doc-biblioref">Swamee and Jain 1976</a>)</span>, shown in Equation <a href="water-flowing-in-pipes.html#eq:swam1">(4.7)</a>.
<span class="math display" id="eq:swam1">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7}+\frac{5.74}{Re^{0.9}}\right)
  \tag{4.7}
\end{equation}\]</span></p>
<p>These approximations are useful for solving problems by hand or in spreadsheets, and their accuracy is generally within the uncertainty of other input variables like the absolute roughness.</p>
</div>
<div id="coleb-solver" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Solving for head loss using an equation solver<a href="water-flowing-in-pipes.html#coleb-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rather than use an empirical approximation (as in Section <a href="#dwapprox"><strong>??</strong></a>) to the Colebrook equation, it is straightforward to apply an equation solver to use the Colebrook equation directly. This is demonstrated in Example @ref(exm:pipe-1.2).</p>
<div class="example">
<p><span id="exm:pipe-1.2" class="example"><strong>(#exm:pipe-1.2) </strong></span>Find the friction factor for the same conditions as Example @ref(exm:pipe-1.1): D=0.5m, k<sub>s</sub>=0.046mm, and Re=1.036e+06.</p>
</div>
<p>First, rearrange the Colebrook equation so all terms are on one side of the equation, as in Equation <a href="water-flowing-in-pipes.html#eq:coleb-2">(4.8)</a>.
<span class="math display" id="eq:coleb-2">\[\begin{equation}
  -2\log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{2.51}{Re\sqrt{f}}\right) - \frac{1}{\sqrt{f}}=0
  \tag{4.8}
\end{equation}\]</span></p>
<p>Create a function using whatever equation solving platform you prefer. Here the R software is used:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="water-flowing-in-pipes.html#cb4-1" aria-hidden="true" tabindex="-1"></a>colebrk <span class="ot">&lt;-</span> <span class="cf">function</span>(f,ks,D,Re) <span class="sc">-</span><span class="fl">2.0</span><span class="sc">*</span><span class="fu">log10</span>((ks<span class="sc">/</span>D)<span class="sc">/</span><span class="fl">3.7</span> <span class="sc">+</span> <span class="fl">2.51</span><span class="sc">/</span>(Re<span class="sc">*</span>(f<span class="sc">^</span><span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(f<span class="sc">^</span><span class="fl">0.5</span>)</span></code></pre></div>
<p>Find the root of the function (where it equals zero), specifying a reasonable range for f values using the <em>interval</em> argument:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="water-flowing-in-pipes.html#cb5-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(colebrk, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.008</span>,<span class="fl">0.1</span>), <span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">D=</span><span class="fl">0.5</span>, <span class="at">Re=</span><span class="fl">1.036e+06</span>)<span class="sc">$</span>root</span>
<span id="cb5-2"><a href="water-flowing-in-pipes.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;f = %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, f))</span>
<span id="cb5-3"><a href="water-flowing-in-pipes.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; f = 0.0133</span></span></code></pre></div>
<p>The same value for h<sub>f</sub> as above results.</p>
</div>
<div id="solving-for-head-loss-using-an-r-package" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Solving for head loss using an R package<a href="water-flowing-in-pipes.html#solving-for-head-loss-using-an-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Equation solvers for implicit equations, like in Section <a href="water-flowing-in-pipes.html#coleb-solver">4.4.2</a>, are built into the R package <em>hydraulics</em>. that can be applied directly, without writing a separate function.</p>
<div class="example">
<p><span id="exm:pipe-1.3" class="example"><strong>(#exm:pipe-1.3) </strong></span>Using the <em>hydraulics</em> R package, find the friction factor and head loss for the same conditions as Example @ref(exm:pipe-1.2): Q=0.416 m<sup>3</sup>/s, L=100 m, D=0.5m, k<sub>s</sub>=0.046mm, and nu = 1.023053e-06 m<sup>2</sup>/s.</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="water-flowing-in-pipes.html#cb6-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">darcyweisbach</span>(<span class="at">Q =</span> <span class="fl">0.416</span>,<span class="at">D =</span> <span class="fl">0.5</span>, <span class="at">L =</span> <span class="dv">100</span>, <span class="at">ks =</span> <span class="fl">0.000046</span>, </span>
<span id="cb6-2"><a href="water-flowing-in-pipes.html#cb6-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nu =</span> <span class="fl">1.023053e-06</span>, <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&quot;SI&quot;</span>))</span>
<span id="cb6-3"><a href="water-flowing-in-pipes.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hf missing: solving a Type 1 problem</span></span>
<span id="cb6-4"><a href="water-flowing-in-pipes.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Reynolds no: %.0f</span><span class="sc">\n</span><span class="st">Friction Fact: %.4f</span><span class="sc">\n</span><span class="st">Head Loss: %.2f ft</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb6-5"><a href="water-flowing-in-pipes.html#cb6-5" aria-hidden="true" tabindex="-1"></a>            ans<span class="sc">$</span>Re, ans<span class="sc">$</span>f, ans<span class="sc">$</span>hf))</span>
<span id="cb6-6"><a href="water-flowing-in-pipes.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Reynolds no: 1035465</span></span>
<span id="cb6-7"><a href="water-flowing-in-pipes.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Friction Fact: 0.0133</span></span>
<span id="cb6-8"><a href="water-flowing-in-pipes.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Head Loss: 0.61 ft</span></span></code></pre></div>
<p>If only the <em>f</em> value is needed, the <em>colebrook</em> equation can be used.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="water-flowing-in-pipes.html#cb7-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">colebrook</span>(<span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">V=</span> <span class="fl">2.120</span>, <span class="at">D=</span><span class="fl">0.5</span>, <span class="at">nu=</span><span class="fl">1.023e-06</span>)</span>
<span id="cb7-2"><a href="water-flowing-in-pipes.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;f = %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, f))</span>
<span id="cb7-3"><a href="water-flowing-in-pipes.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; f = 0.0133</span></span></code></pre></div>
<p>Notice that the <em>colebrook</em> function needs input in dimensionally consistent units. Because it is dimensionally homogeneous and the input dimensions are consistent, the unit system does not need to be defined like with many other functions in the <em>hydraulics</em> package.</p>
</div>
</div>
<div id="solving-for-flow-or-velocity-type-2-problems" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Solving for Flow or Velocity (Type 2 problems)<a href="water-flowing-in-pipes.html#solving-for-flow-or-velocity-type-2-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When flow (Q) or velocity (V) is unknown, the Reynolds number cannot be determined, complicating the solution of the Colebrook equation. As with Secion <a href="water-flowing-in-pipes.html#type1">4.4</a> there are several strategies to solving these, ranging from iterative manual calculations to using software packages. For Type 2 problems, since D is known, once either V or Q is known, the other is known, since <span class="math inline">\(Q=V{\cdot}A=V\frac{\pi}{4}D^2\)</span>.</p>
<div id="solving-for-q-or-v-using-manual-iteration" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Solving for Q (or V) using manual iteration<a href="water-flowing-in-pipes.html#solving-for-q-or-v-using-manual-iteration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Solving a Type 2 problem can be done with manual iterations, as demonstrated in Example @ref(exm:pipe-2.1).</p>
<div class="example">
<p><span id="exm:pipe-2.1" class="example"><strong>(#exm:pipe-2.1) </strong></span>find the flow rate, <em>Q</em> of 20<sup>o</sup>C water in a pipe with the following characteristics: h<sub>f</sub>=0.6m, L=100m, D=0.5m, k<sub>s</sub>=0.046mm.</p>
</div>
<p>First rearrange the Darcy-Weisbach equation to express V as a function of f, substituting all of the known quantities: <span class="math display">\[V = \sqrt{\frac{h_f}{L}\frac{2gD}{f}}=\frac{0.243}{\sqrt{f}}\]</span></p>
<p>That provides one equation relating <em>V</em> and <em>f</em>. The second equation relating <em>V</em> and <em>f</em> is one of the friction factor equations, such as the Colebrook equation or its graphic representation in the Moody diagram. An initial guess at a value for <em>f</em> is obtained using f<sub>min</sub>=0.012 as was done in Example @ref(exm:pipe-1.1).</p>
<p><strong>Iteration 1:</strong> <span class="math inline">\(V=\frac{0.243}{\sqrt{0.012}}=2.218\)</span>; <span class="math inline">\(Re=\frac{2.218\cdot 0.5}{1.023e-06}=1.084 \cdot 10^6\)</span>. A new <em>f</em> value is obtained from the Moody diagram or an equation using the new Re value: <span class="math inline">\(f \approx 0.0131\)</span></p>
<p><strong>Iteration 2:</strong> <span class="math inline">\(V=\frac{0.243}{\sqrt{0.0131}}=2.123\)</span>; <span class="math inline">\(Re=\frac{2.123\cdot 0.5}{1.023e-06}=1.038 \cdot 10^6\)</span>. A new <em>f</em> estimate: <span class="math inline">\(f \approx 0.0132\)</span></p>
<p>The function converges very quickly if a reasonable first guess is made. Using V=2.12 m/s, <span class="math inline">\(Q = AV = \left(\frac{\pi}{4}\right)D^2V=0.416 m^3/s\)</span></p>
</div>
<div id="solving-for-q-using-an-explicit-equation" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Solving for Q Using an Explicit Equation<a href="water-flowing-in-pipes.html#solving-for-q-using-an-explicit-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Solving Type 2 problems using iteration is not necessary, since an explicit equation based on the Colebrook equation can be derived. Solving the Darcy Weisbach equation for <span class="math inline">\(\frac{1}{\sqrt{f}}\)</span> and substituting that into the Colebrook equation produces Equation <a href="water-flowing-in-pipes.html#eq:coleb-3">(4.9)</a>.
<span class="math display" id="eq:coleb-3">\[\begin{equation}
  Q=-2.221D^2\sqrt{\frac{gDh_f}{L}} \log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{1.784\nu}{D}\sqrt{\frac{L}{gDh_f}}\right)
  \tag{4.9}
\end{equation}\]</span></p>
<p>This can be solved explicitly for Q=0.413 m<sup>3</sup>/s.</p>
</div>
<div id="solving-for-q-using-an-r-package" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Solving for Q Using an R package<a href="water-flowing-in-pipes.html#solving-for-q-using-an-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using software to solve the problem allows the use of the Colebrook equation in a straightforward format. The <em>hydraulics</em> package in R is applied to the same problem as above.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="water-flowing-in-pipes.html#cb8-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">darcyweisbach</span>(<span class="at">D=</span><span class="fl">0.5</span>, <span class="at">hf=</span><span class="fl">0.6</span>, <span class="at">L=</span><span class="dv">100</span>, <span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">nu=</span><span class="fl">1.023e-06</span>, <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&#39;SI&#39;</span>))</span>
<span id="cb8-2"><a href="water-flowing-in-pipes.html#cb8-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">format</span>(<span class="fu">as.data.frame</span>(ans), <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">format =</span> <span class="st">&quot;pipe&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Q</th>
<th align="left">V</th>
<th align="left">L</th>
<th align="left">D</th>
<th align="left">hf</th>
<th align="left">f</th>
<th align="left">ks</th>
<th align="left">Re</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0.406</td>
<td align="left">2.07</td>
<td align="left">100</td>
<td align="left">0.5</td>
<td align="left">0.6</td>
<td align="left">0.0133</td>
<td align="left">4.6e-05</td>
<td align="left">1010392</td>
</tr>
</tbody>
</table>
<p>The answer differs from the manual iteration by just over 2%, showing remarkable consistency.</p>
</div>
</div>
<div id="solving-for-pipe-diameter-d-type-3-problems" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Solving for pipe diameter, D (Type 3 problems)<a href="water-flowing-in-pipes.html#solving-for-pipe-diameter-d-type-3-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When D is unknown, neither Re nor relative roughness <span class="math inline">\(\frac{ks}{D}\)</span> are known. Referring to the Moody diagram (Figure <a href="water-flowing-in-pipes.html#fig:moody1">4.1</a>), the difficulty in estimating a value for <em>f</em> (on the left axis) is evident since the positions on either the right axis (<span class="math inline">\(\frac{ks}{D}\)</span>) or x-axis (<em>Re</em>) are known.</p>
<div id="solving-for-d-using-manual-iterations" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Solving for D using manual iterations<a href="water-flowing-in-pipes.html#solving-for-d-using-manual-iterations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Solving for D using manual iterations is done by first rearranging Equation <a href="water-flowing-in-pipes.html#eq:coleb-3">(4.9)</a> to allow it to be solved for zero, as in Equation <a href="water-flowing-in-pipes.html#eq:coleb-4">(4.10)</a>.
<span class="math display" id="eq:coleb-4">\[\begin{equation}
  -2.221D^2\sqrt{\frac{gDh_f}{L}} \log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{1.784\nu}{D}\sqrt{\frac{L}{gDh_f}}\right)-Q=0
  \tag{4.10}
\end{equation}\]</span></p>
<p>Using this with manual iterations is demonstrated in Example @ref(exm:pipe-3.1).</p>
<div class="example">
<p><span id="exm:pipe-3.1" class="example"><strong>(#exm:pipe-3.1) </strong></span>For a similar problem to @ref(exm:pipe-2.1) use Q=0.416m<sup>3</sup>/s and solve for the required pipe diameter, D.</p>
</div>
<p>This can be solved manually by guessing values and repeating the calculation in a spreadsheet or with a tool like R.</p>
<p><strong>Iteration 1:</strong> Guess an arbitrary value of D=0.3m. Solve the left side of Equation <a href="water-flowing-in-pipes.html#eq:coleb-4">(4.10)</a> to obtain a value of -0.31</p>
<p><strong>Iteration 2:</strong> Guess another value for D=1.0m. The left side of Equation <a href="water-flowing-in-pipes.html#eq:coleb-4">(4.10)</a> produces a value for the function of 2.11</p>
<p>The root, when the function equals zero, lies between the two values, so the correct D is between 0.3 and 1.0. Repeated values can home in on a solution. Plotting the results from many trials can help guide toward the solution.
<img src="images/type3_guesses.png" width="258" style="display: block; margin: auto;" />
The root is seen to lie very close to D=0.5 m. Repeated trials can home in on the result.</p>
</div>
<div id="solving-for-d-using-an-equation-solver" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Solving for D using an equation solver<a href="water-flowing-in-pipes.html#solving-for-d-using-an-equation-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An equation solver automatically accomplishes the manual steps of the prior demonstration. The equation from 1.6 can be written as a function that can then be solved for the root, again using <em>R</em> software for the demonstration:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="water-flowing-in-pipes.html#cb9-1" aria-hidden="true" tabindex="-1"></a>q_fcn <span class="ot">&lt;-</span> <span class="cf">function</span>(D, Q, hf, L, ks, nu, g) {</span>
<span id="cb9-2"><a href="water-flowing-in-pipes.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">2.221</span> <span class="sc">*</span> D<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(( g <span class="sc">*</span> D <span class="sc">*</span> hf)<span class="sc">/</span>L) <span class="sc">*</span> <span class="fu">log10</span>((ks<span class="sc">/</span>D)<span class="sc">/</span><span class="fl">3.7</span> <span class="sc">+</span> (<span class="fl">1.784</span> <span class="sc">*</span> nu<span class="sc">/</span>D) <span class="sc">*</span> <span class="fu">sqrt</span>(L<span class="sc">/</span>(g <span class="sc">*</span> D <span class="sc">*</span> hf))) <span class="sc">-</span> Q</span>
<span id="cb9-3"><a href="water-flowing-in-pipes.html#cb9-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <em>uniroot</em> function can solve the equation in R (or use a comparable approach in other software) for a reasonable range of D values</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="water-flowing-in-pipes.html#cb10-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(q_fcn, <span class="at">interval=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">4.0</span>),<span class="at">Q=</span><span class="fl">0.416</span>, <span class="at">hf=</span><span class="fl">0.6</span>, <span class="at">L=</span><span class="dv">100</span>, <span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">nu=</span><span class="fl">1.023053e-06</span>, <span class="at">g=</span><span class="fl">9.81</span>)<span class="sc">$</span>root</span>
<span id="cb10-2"><a href="water-flowing-in-pipes.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;D = %.3f m</span><span class="sc">\n</span><span class="st">&quot;</span>, ans))</span>
<span id="cb10-3"><a href="water-flowing-in-pipes.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D = 0.501 m</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="properties-of-water.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="flow-in-open-channels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["hydr-watres_main.pdf", "hydr-watres_main.html"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
