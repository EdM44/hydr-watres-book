<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Water Flowing in Pipes: Energy Losses | Hydraulics and Water Resources: Examples Using R</title>
  <meta name="description" content="<p>A compilation of fluid mechanics, hydraulics, and water resources
engineering exercises using R.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Water Flowing in Pipes: Energy Losses | Hydraulics and Water Resources: Examples Using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>A compilation of fluid mechanics, hydraulics, and water resources
engineering exercises using R.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Water Flowing in Pipes: Energy Losses | Hydraulics and Water Resources: Examples Using R" />
  
  <meta name="twitter:description" content="<p>A compilation of fluid mechanics, hydraulics, and water resources
engineering exercises using R.</p>" />
  

<meta name="author" content="Ed Maurer" />


<meta name="date" content="2022-11-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="properties-of-water.html"/>
<link rel="next" href="flow-in-open-channels.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydraulics and Water Resources:<br>Examples Using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyight"><i class="fa fa-check"></i>Copyight</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="units-in-fluid-mechanics.html"><a href="units-in-fluid-mechanics.html"><i class="fa fa-check"></i><b>1</b> Units in Fluid Mechanics</a></li>
<li class="chapter" data-level="2" data-path="properties-of-water.html"><a href="properties-of-water.html"><i class="fa fa-check"></i><b>2</b> Properties of Water</a>
<ul>
<li class="chapter" data-level="2.1" data-path="properties-of-water.html"><a href="properties-of-water.html#properties-important-for-water-standing-still"><i class="fa fa-check"></i><b>2.1</b> Properties important for water standing still</a></li>
<li class="chapter" data-level="2.2" data-path="properties-of-water.html"><a href="properties-of-water.html#properties-important-for-moving-water"><i class="fa fa-check"></i><b>2.2</b> Properties important for moving water</a></li>
<li class="chapter" data-level="2.3" data-path="properties-of-water.html"><a href="properties-of-water.html#atmosperic-properties"><i class="fa fa-check"></i><b>2.3</b> Atmosperic Properties</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html"><i class="fa fa-check"></i><b>3</b> Water Flowing in Pipes: Energy Losses</a>
<ul>
<li class="chapter" data-level="3.1" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#important-dimensionless-quantity"><i class="fa fa-check"></i><b>3.1</b> Important dimensionless quantity</a></li>
<li class="chapter" data-level="3.2" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#friction-loss-in-circular-pipes"><i class="fa fa-check"></i><b>3.2</b> Friction Loss in Circular Pipes</a></li>
<li class="chapter" data-level="3.3" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-pipe-friction-problems"><i class="fa fa-check"></i><b>3.3</b> Solving Pipe friction problems</a></li>
<li class="chapter" data-level="3.4" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#type1"><i class="fa fa-check"></i><b>3.4</b> Solving for head loss (Type 1 problems)</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-head-loss-by-manual-iteration"><i class="fa fa-check"></i><b>3.4.1</b> Solving for head loss by manual iteration</a></li>
<li class="chapter" data-level="3.4.2" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#dwapprox"><i class="fa fa-check"></i><b>3.4.2</b> Solving for headloss using an empirical approximation</a></li>
<li class="chapter" data-level="3.4.3" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#coleb-solver"><i class="fa fa-check"></i><b>3.4.3</b> Solving for head loss using an equation solver</a></li>
<li class="chapter" data-level="3.4.4" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-head-loss-using-an-r-package"><i class="fa fa-check"></i><b>3.4.4</b> Solving for head loss using an R package</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-flow-or-velocity-type-2-problems"><i class="fa fa-check"></i><b>3.5</b> Solving for Flow or Velocity (Type 2 problems)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-q-or-v-using-manual-iteration"><i class="fa fa-check"></i><b>3.5.1</b> Solving for Q (or V) using manual iteration</a></li>
<li class="chapter" data-level="3.5.2" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-q-using-an-explicit-equation"><i class="fa fa-check"></i><b>3.5.2</b> Solving for Q Using an Explicit Equation</a></li>
<li class="chapter" data-level="3.5.3" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-q-using-an-r-package"><i class="fa fa-check"></i><b>3.5.3</b> Solving for Q Using an R package</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-pipe-diameter-d-type-3-problems"><i class="fa fa-check"></i><b>3.6</b> Solving for pipe diameter, D (Type 3 problems)</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-d-using-manual-iterations"><i class="fa fa-check"></i><b>3.6.1</b> Solving for D using manual iterations</a></li>
<li class="chapter" data-level="3.6.2" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#solving-for-d-using-an-equation-solver"><i class="fa fa-check"></i><b>3.6.2</b> Solving for D using an equation solver</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#parallel-pipes-solving-a-system-of-equations"><i class="fa fa-check"></i><b>3.7</b> Parallel pipes: solving a system of equations</a></li>
<li class="chapter" data-level="3.8" data-path="water-flowing-in-pipes-energy-losses.html"><a href="water-flowing-in-pipes-energy-losses.html#simple-pipe-networks-the-hardy-cross-method"><i class="fa fa-check"></i><b>3.8</b> Simple pipe networks: the Hardy-Cross method</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html"><i class="fa fa-check"></i><b>4</b> Flow in open channels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#an-important-dimensionless-quantity"><i class="fa fa-check"></i><b>4.1</b> An important dimensionless quantity</a></li>
<li class="chapter" data-level="4.2" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#equations-for-open-channel-flow"><i class="fa fa-check"></i><b>4.2</b> Equations for open channel flow</a></li>
<li class="chapter" data-level="4.3" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#trap"><i class="fa fa-check"></i><b>4.3</b> Trapezoidal channels</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#solving-the-manning-equation-in-r"><i class="fa fa-check"></i><b>4.3.1</b> Solving the Manning equation in R</a></li>
<li class="chapter" data-level="4.3.2" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#solving-the-manning-equation-with-the-hydraulics-r-package"><i class="fa fa-check"></i><b>4.3.2</b> Solving the Manning equation with the <em>hydraulics</em> R package</a></li>
<li class="chapter" data-level="4.3.3" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#solving-the-manning-equation-using-a-spreadsheet-like-excel"><i class="fa fa-check"></i><b>4.3.3</b> Solving the Manning equation using a spreadsheet like Excel</a></li>
<li class="chapter" data-level="4.3.4" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#optimal-trapezoidal-geometry"><i class="fa fa-check"></i><b>4.3.4</b> Optimal trapezoidal geometry</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#circ"><i class="fa fa-check"></i><b>4.4</b> Circular Channels (flowing partially full)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#solving-the-manning-equation-for-a-circular-pipe-in-r"><i class="fa fa-check"></i><b>4.4.1</b> Solving the Manning equation for a circular pipe in R</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#crit-section"><i class="fa fa-check"></i><b>4.5</b> Critical flow</a></li>
<li class="chapter" data-level="4.6" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#gvf-section"><i class="fa fa-check"></i><b>4.6</b> Gradually varied steady flow</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#the-direct-step-method"><i class="fa fa-check"></i><b>4.6.1</b> The direct step method</a></li>
<li class="chapter" data-level="4.6.2" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#standard-step-method"><i class="fa fa-check"></i><b>4.6.2</b> Standard step method</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#hj-section"><i class="fa fa-check"></i><b>4.7</b> Rapidly varied flow (the hydraulic jump)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#sequent-or-conjugate-depths"><i class="fa fa-check"></i><b>4.7.1</b> Sequent (or conjugate) depths</a></li>
<li class="chapter" data-level="4.7.2" data-path="flow-in-open-channels.html"><a href="flow-in-open-channels.html#location-of-a-hydraulic-jump"><i class="fa fa-check"></i><b>4.7.2</b> Location of a hydraulic jump</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="momentum-in-water-flow.html"><a href="momentum-in-water-flow.html"><i class="fa fa-check"></i><b>5</b> Momentum in water flow</a>
<ul>
<li class="chapter" data-level="5.1" data-path="momentum-in-water-flow.html"><a href="momentum-in-water-flow.html#equations-of-linear-momentum"><i class="fa fa-check"></i><b>5.1</b> Equations of linear momentum</a></li>
<li class="chapter" data-level="5.2" data-path="momentum-in-water-flow.html"><a href="momentum-in-water-flow.html#the-momentum-equation-in-pipe-design"><i class="fa fa-check"></i><b>5.2</b> The momentum equation in pipe design</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pumps-and-how-they-operate-in-a-hydraulic-system.html"><a href="pumps-and-how-they-operate-in-a-hydraulic-system.html"><i class="fa fa-check"></i><b>6</b> Pumps and how they operate in a hydraulic system</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pumps-and-how-they-operate-in-a-hydraulic-system.html"><a href="pumps-and-how-they-operate-in-a-hydraulic-system.html#defining-the-system-curve"><i class="fa fa-check"></i><b>6.1</b> Defining the system curve</a></li>
<li class="chapter" data-level="6.2" data-path="pumps-and-how-they-operate-in-a-hydraulic-system.html"><a href="pumps-and-how-they-operate-in-a-hydraulic-system.html#defining-the-pump-characteristic-curve"><i class="fa fa-check"></i><b>6.2</b> Defining the pump characteristic curve</a></li>
<li class="chapter" data-level="6.3" data-path="pumps-and-how-they-operate-in-a-hydraulic-system.html"><a href="pumps-and-how-they-operate-in-a-hydraulic-system.html#finding-the-operating-point"><i class="fa fa-check"></i><b>6.3</b> Finding the operating point</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydraulics and Water Resources: Examples Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="water-flowing-in-pipes-energy-losses" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Water Flowing in Pipes: Energy Losses<a href="water-flowing-in-pipes-energy-losses.html#water-flowing-in-pipes-energy-losses" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Flow in civil engineering infrastructure is usually either in pipes, where it is not exposed to the atmosphere and flows under pressure, or open channels (canals, rivers, etc.). this chapter is concerned only with water flow in pipes.</p>
<p><img src="images/pressurized-water-pipe.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p>Once water begins to move engineering problems often need to relate the flow rate to the energy dissipated. To accomplish this, the flow needs to be classified using dimensionless constants since energy dissipation varies with the flow conditions.</p>
<div id="important-dimensionless-quantity" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Important dimensionless quantity<a href="water-flowing-in-pipes-energy-losses.html#important-dimensionless-quantity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As water begins to move, the characteristics are described by two quantities in engineering hydraulics: the Reynolds number, <em>Re</em> and the Froude number <em>Fr</em>. The latter is more important for open channel flow and will be discussed in that chapter.</p>
<p>Reynolds number describes the turbulence of the flow, defined by the ratio of kinematic forces, expressed by velocity <em>V</em> and a characteristic length such as pipe diameter, <em>D</em>, to viscous forces as expressed by the kinematic viscosity <span class="math inline">\(\nu\)</span>, as in Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:reynolds">(3.1)</a></p>
<p><span class="math display" id="eq:reynolds">\[\begin{equation}
  Re=\frac{VD}{\nu}
  \tag{3.1}
\end{equation}\]</span></p>
<p>For open channels the characteristic length is the <em>hydraulic depth</em>, the area of flow divided by the top width. For adequately turbulent conditions to exists, Reynolds numbers should exceed 4000 for full pipes, and 2000 for open channels.</p>
</div>
<div id="friction-loss-in-circular-pipes" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Friction Loss in Circular Pipes<a href="water-flowing-in-pipes-energy-losses.html#friction-loss-in-circular-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The energy at any point along a pipe containing flowing water is often described by the energy per unit weight, or energy head, E, as in Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:energy1">(3.2)</a></p>
<p><span class="math display" id="eq:energy1">\[\begin{equation}
  E = z+\frac{P}{\gamma}+\alpha\frac{V^2}{2g}
  \tag{3.2}
\end{equation}\]</span>
where <em>P</em> is the pressure, <span class="math inline">\(\gamma=\rho g\)</span> is the specific weight of water, <em>z</em> is the elevation of the point, <em>V</em> is the average velocity, and each term has units of length. <span class="math inline">\(\alpha\)</span> is a kinetic energy adjustment factor to account for non-uniform velocity distribution across the cross-section. <span class="math inline">\(\alpha\)</span> is typically assumed to be 1.0 for turbulent flow in circular pipes because the value is close to 1.0 and <span class="math inline">\(\frac{V^2}{2g}\)</span> (the velocity head) tends to be small in relation to other terms in the equation. Some applications where velocity varies widely across a cross-section, such as a river channel with flow in a main channel and a flood plain, will need to account for values of <span class="math inline">\(\alpha\)</span> other than one.</p>
<p>As water flows through a pipe energy is lost due to friction with the pipe walls and local disturbances (minor losses). The energy loss between two sections is expressed as <span class="math inline">\({E_1} - {h_l} = {E_2}\)</span>. When pipes are long, with <span class="math inline">\(\frac{L}{D}&gt;1000\)</span>, friction losses dominate the energy loss on the system, and the head loss, <span class="math inline">\(h_l\)</span>, is calculated as the head loss due to friction, <span class="math inline">\(h_f\)</span>.</p>
<p>This energy head loss due to friction with the walls of the pipe is described by the Darcy-Weisbach equation, which estimates the energy loss per unit weight, or head loss <span class="math inline">\({h_f}\)</span>, which has units of length. For circular pipes it is expressed by Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:d-w1">(3.3)</a></p>
<p><span class="math display" id="eq:d-w1">\[\begin{equation}
  h_f = \frac{fL}{D}\frac{V^2}{2g} = \frac{8fL}{\pi^{2}gD^{5}}Q^{2}
  \tag{3.3}
\end{equation}\]</span></p>
<p>In equation <a href="water-flowing-in-pipes-energy-losses.html#eq:d-w1">(3.3)</a> <em>f</em> is the friction factor, typically calculated with the Colebrook equation (Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb1">(3.4)</a>).</p>
<p><span class="math display" id="eq:coleb1">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{2.51}{Re\sqrt{f}}\right)
  \tag{3.4}
\end{equation}\]</span></p>
<p>In Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb1">(3.4)</a> <span class="math inline">\(k_s\)</span> is the absolute roughness of the pipe wall. There are close approximations to the Colebrook equation that have an explicit form to facilitate hand-calculations, but when using R or other computational tools there is no need to use approximations.</p>
</div>
<div id="solving-pipe-friction-problems" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Solving Pipe friction problems<a href="water-flowing-in-pipes-energy-losses.html#solving-pipe-friction-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As water flows through a pipe energy is lost due to friction with the pipe walls and local disturbances (minor losses). For this example assume minor losses are negligible. The energy head loss due to friction with the walls of the pipe is described by the Darcy-Weisbach equation (Equation (<a href="water-flowing-in-pipes-energy-losses.html#eq:d-w1">(3.3)</a>)), which estimates the energy loss per unit weight, or head loss h<sub>f</sub>, which has units of length. The Colebrook equation (Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb1">(3.4)</a>) is commonly plotted as a Moody diagram to illustrate the relationships between the variables, in Figure <a href="water-flowing-in-pipes-energy-losses.html#fig:moody1">3.1</a>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="water-flowing-in-pipes-energy-losses.html#cb10-1" aria-hidden="true" tabindex="-1"></a>hydraulics<span class="sc">::</span><span class="fu">moody</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:moody1"></span>
<img src="hydr-watres_main_files/figure-html/moody1-1.png" alt="Moody Diagram" width="672" />
<p class="caption">
Figure 3.1: Moody Diagram
</p>
</div>
<p>Because of the form of the equations, they can sometimes be a challenge to solve, especially by hand. It can help to classify the types of problems based on what variable is unknown. These are summarized in Table <a href="water-flowing-in-pipes-energy-losses.html#tab:prob-types">3.1</a>.</p>
<table>
<caption><span id="tab:prob-types">Table 3.1: </span>Types of Energy Loss Problems in Pipe Flow</caption>
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Known</th>
<th align="left">Unknown</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Q (or V), D, ks, L</td>
<td align="left">hL</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">hL, D, ks, L</td>
<td align="left">Q (or V)</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">hL, Q (or V), ks, L</td>
<td align="left">D</td>
</tr>
</tbody>
</table>
<p>When solving by hand the types in Table <a href="water-flowing-in-pipes-energy-losses.html#tab:prob-types">3.1</a> become progressively more difficult, but when using solvers the difference in complexity is subtle.</p>
</div>
<div id="type1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Solving for head loss (Type 1 problems)<a href="water-flowing-in-pipes-energy-losses.html#type1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simplest pipe flow problem to solve is when the unknown is head loss, h<sub>f</sub> (equivalent to h<sub>L</sub> in the absence of minor losses), since all variables on the right side of the Darcy-Weisbach equation are known, except <em>f</em>.</p>
<div id="solving-for-head-loss-by-manual-iteration" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Solving for head loss by manual iteration<a href="water-flowing-in-pipes-energy-losses.html#solving-for-head-loss-by-manual-iteration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While all unknowns are on the right side of Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:d-w1">(3.3)</a>, iteration is still required because the Colebrook equation, Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb1">(3.4)</a>, cannot be solved explicitly for <em>f</em>. An illustration of solving this type of problem is shown in Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-1-1">3.1</a>.</p>
<div class="example">
<p><span id="exm:pipe-1-1" class="example"><strong>Example 3.1  </strong></span>Find the head loss (due to friction) of 20<span class="math inline">\(^\circ\)</span>C water in a pipe with the following characteristics: Q=0.416 m<span class="math inline">\(^3\)</span>/s, L=100m, D=0.5m, k<sub>s</sub>=0.046mm.</p>
</div>
<p>Since the water temperature is known, first find the kinematic viscocity of water, <span class="math inline">\({\nu}\)</span>, since it is needed for the Reynolds number. This can be obtained from a table in a reference or using software. Here we will use the <em>hydraulics</em> R package.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="water-flowing-in-pipes-energy-losses.html#cb11-1" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">kvisc</span>(<span class="at">T=</span><span class="dv">20</span>, <span class="at">units=</span><span class="st">&quot;SI&quot;</span>)</span>
<span id="cb11-2"><a href="water-flowing-in-pipes-energy-losses.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Kinematic viscosity = %.3e m2/s</span><span class="sc">\n</span><span class="st">&quot;</span>, nu))</span>
<span id="cb11-3"><a href="water-flowing-in-pipes-energy-losses.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Kinematic viscosity = 1.023e-06 m2/s</span></span></code></pre></div>
<p>We will need the Reynolds Number to use the Colebrook equation, and that can be calculated since Q is known. This can be accomplished with a calculator, or using other software (R is used here):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="water-flowing-in-pipes-energy-losses.html#cb12-1" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fl">0.416</span></span>
<span id="cb12-2"><a href="water-flowing-in-pipes-energy-losses.html#cb12-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-3"><a href="water-flowing-in-pipes-energy-losses.html#cb12-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> (<span class="fl">3.14</span><span class="sc">/</span><span class="dv">4</span>)<span class="sc">*</span>D<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-4"><a href="water-flowing-in-pipes-energy-losses.html#cb12-4" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> Q<span class="sc">/</span>A</span>
<span id="cb12-5"><a href="water-flowing-in-pipes-energy-losses.html#cb12-5" aria-hidden="true" tabindex="-1"></a>Re <span class="ot">&lt;-</span> V<span class="sc">*</span>D<span class="sc">/</span>nu</span>
<span id="cb12-6"><a href="water-flowing-in-pipes-energy-losses.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Velocity = %.3f m/s, Re = %.3e</span><span class="sc">\n</span><span class="st">&quot;</span>, V, Re))</span>
<span id="cb12-7"><a href="water-flowing-in-pipes-energy-losses.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Velocity = 2.120 m/s, Re = 1.036e+06</span></span></code></pre></div>
<p>Now the only unknown in the Colebrook equation is <em>f</em>, but unfortunately <em>f</em> appears on both sides of the equation.</p>
<p>To begin the iterative process, a first guess at <em>f</em> is needed. A reasonable value to use is the minimum f value, f<sub>min</sub>, given the known <span class="math inline">\(\frac{k_s}{D}=\frac{0.046}{500}=0.000092=9.2\cdot 10^{-5}\)</span>.
Reading horizontally from the right vertical axis to the left on the Moody diagram provides a value for <span class="math inline">\(f_{min}\approx 0.012\)</span>.</p>
<p>Numerically, it can be seen that <em>f</em> is independent of <em>Re</em> for large values of <em>Re</em>. When <em>Re</em> is large the second term of the Colebrook equation becomes small and the equation approaches Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-rough">(3.5)</a>.
<span class="math display" id="eq:coleb-rough">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7}\right)
  \tag{3.5}
\end{equation}\]</span>
This independence of <em>f</em> with varying <em>Re</em> values is visible in the Moody Diagram, Figure <a href="water-flowing-in-pipes-energy-losses.html#fig:moody1">3.1</a>, toward the right, where the lines become horizontal.</p>
<p>Using Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-rough">(3.5)</a> the same value of f<sub>min</sub>=0.012 is obtained, since the colebrook equation defines the Moody diagram.</p>
<p><strong>Iteration 1:</strong> Using f=0.012 the right side of the Colebrook equation is 8.656. the next estimate for <em>f</em> is then obtained by <span class="math inline">\(\frac{1}{\sqrt{f}}=8.656\)</span> so f=0.0133.</p>
<p><strong>Iteration 2:</strong> Using the new value of f=0.0133 in the right side of the Colebrook equation produces 8.677. A new value for <em>f</em> is obtained by <span class="math inline">\(\frac{1}{\sqrt{f}}=8.677\)</span> so f=0.0133. The solution has converged!</p>
<p>Using the new value of <em>f</em>, the value for h<sub>f</sub> is calculated:
<span class="math display">\[h_f = \frac{8fL}{\pi^{2}gD^{5}}Q^{2}=\frac{8(0.0133)(100)}{\pi^{2}(9.81)(0.5)^{5}}(0.416)^{2}=0.061 m\]</span></p>
</div>
<div id="dwapprox" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Solving for headloss using an empirical approximation<a href="water-flowing-in-pipes-energy-losses.html#dwapprox" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A shortcut that can be used to avoid iterating to find the friction factor is to use an approximation to the Colebrook equation that can be solved explicitly. One example is the Haaland equation <a href="water-flowing-in-pipes-energy-losses.html#eq:haal">(3.6)</a> <span class="citation">(<a href="references.html#ref-haaland_simple_1983" role="doc-biblioref">Haaland 1983</a>)</span>.
<span class="math display" id="eq:haal">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -1.8\log\left(\left(\frac{\frac{k_s}{D}}{3.7}\right)^{1.11}+\frac{6.9}{Re}\right)
  \tag{3.6}
\end{equation}\]</span></p>
<p>For ordinary pipe flow conditions in water pipes, Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:haal">(3.6)</a> is accurate to within 1.5% of the Colebrook equation. There are many other empirical equations, one common one being that of Swamee and Jain <span class="citation">(<a href="references.html#ref-swamee_explicit_1976" role="doc-biblioref">Swamee and Jain 1976</a>)</span>, shown in Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:swam1">(3.7)</a>.
<span class="math display" id="eq:swam1">\[\begin{equation}
  \frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7}+\frac{5.74}{Re^{0.9}}\right)
  \tag{3.7}
\end{equation}\]</span></p>
<p>These approximations are useful for solving problems by hand or in spreadsheets, and their accuracy is generally within the uncertainty of other input variables like the absolute roughness.</p>
</div>
<div id="coleb-solver" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Solving for head loss using an equation solver<a href="water-flowing-in-pipes-energy-losses.html#coleb-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rather than use an empirical approximation (as in Section <a href="water-flowing-in-pipes-energy-losses.html#dwapprox">3.4.2</a>) to the Colebrook equation, it is straightforward to apply an equation solver to use the Colebrook equation directly. This is demonstrated in Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-1-2">3.2</a>.</p>
<div class="example">
<p><span id="exm:pipe-1-2" class="example"><strong>Example 3.2  </strong></span>Find the friction factor for the same conditions as Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-1-1">3.1</a>: D=0.5m, k<sub>s</sub>=0.046mm, and Re=1.036e+06.</p>
</div>
<p>First, rearrange the Colebrook equation so all terms are on one side of the equation, as in Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-2">(3.8)</a>.
<span class="math display" id="eq:coleb-2">\[\begin{equation}
  -2\log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{2.51}{Re\sqrt{f}}\right) - \frac{1}{\sqrt{f}}=0
  \tag{3.8}
\end{equation}\]</span></p>
<p>Create a function using whatever equation solving platform you prefer. Here the R software is used:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="water-flowing-in-pipes-energy-losses.html#cb13-1" aria-hidden="true" tabindex="-1"></a>colebrk <span class="ot">&lt;-</span> <span class="cf">function</span>(f,ks,D,Re) <span class="sc">-</span><span class="fl">2.0</span><span class="sc">*</span><span class="fu">log10</span>((ks<span class="sc">/</span>D)<span class="sc">/</span><span class="fl">3.7</span> <span class="sc">+</span> <span class="fl">2.51</span><span class="sc">/</span>(Re<span class="sc">*</span>(f<span class="sc">^</span><span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(f<span class="sc">^</span><span class="fl">0.5</span>)</span></code></pre></div>
<p>Find the root of the function (where it equals zero), specifying a reasonable range for f values using the <em>interval</em> argument:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="water-flowing-in-pipes-energy-losses.html#cb14-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(colebrk, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.008</span>,<span class="fl">0.1</span>), <span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">D=</span><span class="fl">0.5</span>, <span class="at">Re=</span><span class="fl">1.036e+06</span>)<span class="sc">$</span>root</span>
<span id="cb14-2"><a href="water-flowing-in-pipes-energy-losses.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;f = %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, f))</span>
<span id="cb14-3"><a href="water-flowing-in-pipes-energy-losses.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; f = 0.0133</span></span></code></pre></div>
<p>The same value for h<sub>f</sub> as above results.</p>
</div>
<div id="solving-for-head-loss-using-an-r-package" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Solving for head loss using an R package<a href="water-flowing-in-pipes-energy-losses.html#solving-for-head-loss-using-an-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Equation solvers for implicit equations, like in Section <a href="water-flowing-in-pipes-energy-losses.html#coleb-solver">3.4.3</a>, are built into the R package <em>hydraulics</em>. that can be applied directly, without writing a separate function.</p>
<div class="example">
<p><span id="exm:pipe-1-3" class="example"><strong>Example 3.3  </strong></span>Using the <em>hydraulics</em> R package, find the friction factor and head loss for the same conditions as Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-1-2">3.2</a>: Q=0.416 m<sup>3</sup>/s, L=100 m, D=0.5m, k<sub>s</sub>=0.046mm, and nu = 1.023053e-06 m<sup>2</sup>/s.</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="water-flowing-in-pipes-energy-losses.html#cb15-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">darcyweisbach</span>(<span class="at">Q =</span> <span class="fl">0.416</span>,<span class="at">D =</span> <span class="fl">0.5</span>, <span class="at">L =</span> <span class="dv">100</span>, <span class="at">ks =</span> <span class="fl">0.000046</span>, </span>
<span id="cb15-2"><a href="water-flowing-in-pipes-energy-losses.html#cb15-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nu =</span> <span class="fl">1.023053e-06</span>, <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&quot;SI&quot;</span>))</span>
<span id="cb15-3"><a href="water-flowing-in-pipes-energy-losses.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hf missing: solving a Type 1 problem</span></span>
<span id="cb15-4"><a href="water-flowing-in-pipes-energy-losses.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Reynolds no: %.0f</span><span class="sc">\n</span><span class="st">Friction Fact: %.4f</span><span class="sc">\n</span><span class="st">Head Loss: %.2f ft</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb15-5"><a href="water-flowing-in-pipes-energy-losses.html#cb15-5" aria-hidden="true" tabindex="-1"></a>            ans<span class="sc">$</span>Re, ans<span class="sc">$</span>f, ans<span class="sc">$</span>hf))</span>
<span id="cb15-6"><a href="water-flowing-in-pipes-energy-losses.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Reynolds no: 1035465</span></span>
<span id="cb15-7"><a href="water-flowing-in-pipes-energy-losses.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Friction Fact: 0.0133</span></span>
<span id="cb15-8"><a href="water-flowing-in-pipes-energy-losses.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Head Loss: 0.61 ft</span></span></code></pre></div>
<p>If only the <em>f</em> value is needed, the <em>colebrook</em> function can be used.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="water-flowing-in-pipes-energy-losses.html#cb16-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">colebrook</span>(<span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">V=</span> <span class="fl">2.120</span>, <span class="at">D=</span><span class="fl">0.5</span>, <span class="at">nu=</span><span class="fl">1.023e-06</span>)</span>
<span id="cb16-2"><a href="water-flowing-in-pipes-energy-losses.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;f = %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, f))</span>
<span id="cb16-3"><a href="water-flowing-in-pipes-energy-losses.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; f = 0.0133</span></span></code></pre></div>
<p>Notice that the <em>colebrook</em> function needs input in dimensionally consistent units. Because it is dimensionally homogeneous and the input dimensions are consistent, the unit system does not need to be defined like with many other functions in the <em>hydraulics</em> package.</p>
</div>
</div>
<div id="solving-for-flow-or-velocity-type-2-problems" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Solving for Flow or Velocity (Type 2 problems)<a href="water-flowing-in-pipes-energy-losses.html#solving-for-flow-or-velocity-type-2-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When flow (Q) or velocity (V) is unknown, the Reynolds number cannot be determined, complicating the solution of the Colebrook equation. As with Secion <a href="water-flowing-in-pipes-energy-losses.html#type1">3.4</a> there are several strategies to solving these, ranging from iterative manual calculations to using software packages. For Type 2 problems, since D is known, once either V or Q is known, the other is known, since <span class="math inline">\(Q=V{\cdot}A=V\frac{\pi}{4}D^2\)</span>.</p>
<div id="solving-for-q-or-v-using-manual-iteration" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Solving for Q (or V) using manual iteration<a href="water-flowing-in-pipes-energy-losses.html#solving-for-q-or-v-using-manual-iteration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Solving a Type 2 problem can be done with manual iterations, as demonstrated in Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-2-1">3.4</a>.</p>
<div class="example">
<p><span id="exm:pipe-2-1" class="example"><strong>Example 3.4  </strong></span>find the flow rate, <em>Q</em> of 20<sup>o</sup>C water in a pipe with the following characteristics: h<sub>f</sub>=0.6m, L=100m, D=0.5m, k<sub>s</sub>=0.046mm.</p>
</div>
<p>First rearrange the Darcy-Weisbach equation to express V as a function of f, substituting all of the known quantities: <span class="math display">\[V = \sqrt{\frac{h_f}{L}\frac{2gD}{f}}=\frac{0.243}{\sqrt{f}}\]</span></p>
<p>That provides one equation relating <em>V</em> and <em>f</em>. The second equation relating <em>V</em> and <em>f</em> is one of the friction factor equations, such as the Colebrook equation or its graphic representation in the Moody diagram. An initial guess at a value for <em>f</em> is obtained using f<sub>min</sub>=0.012 as was done in Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-1-1">3.1</a>.</p>
<p><strong>Iteration 1:</strong> <span class="math inline">\(V=\frac{0.243}{\sqrt{0.012}}=2.218\)</span>; <span class="math inline">\(Re=\frac{2.218\cdot 0.5}{1.023e-06}=1.084 \cdot 10^6\)</span>. A new <em>f</em> value is obtained from the Moody diagram or an equation using the new Re value: <span class="math inline">\(f \approx 0.0131\)</span></p>
<p><strong>Iteration 2:</strong> <span class="math inline">\(V=\frac{0.243}{\sqrt{0.0131}}=2.123\)</span>; <span class="math inline">\(Re=\frac{2.123\cdot 0.5}{1.023e-06}=1.038 \cdot 10^6\)</span>. A new <em>f</em> estimate: <span class="math inline">\(f \approx 0.0132\)</span></p>
<p>The function converges very quickly if a reasonable first guess is made. Using V=2.12 m/s, <span class="math inline">\(Q = AV = \left(\frac{\pi}{4}\right)D^2V=0.416 m^3/s\)</span></p>
</div>
<div id="solving-for-q-using-an-explicit-equation" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Solving for Q Using an Explicit Equation<a href="water-flowing-in-pipes-energy-losses.html#solving-for-q-using-an-explicit-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Solving Type 2 problems using iteration is not necessary, since an explicit equation based on the Colebrook equation can be derived. Solving the Darcy Weisbach equation for <span class="math inline">\(\frac{1}{\sqrt{f}}\)</span> and substituting that into the Colebrook equation produces Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-3">(3.9)</a>.
<span class="math display" id="eq:coleb-3">\[\begin{equation}
  Q=-2.221D^2\sqrt{\frac{gDh_f}{L}} \log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{1.784\nu}{D}\sqrt{\frac{L}{gDh_f}}\right)
  \tag{3.9}
\end{equation}\]</span></p>
<p>This can be solved explicitly for Q=0.413 m<sup>3</sup>/s.</p>
</div>
<div id="solving-for-q-using-an-r-package" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Solving for Q Using an R package<a href="water-flowing-in-pipes-energy-losses.html#solving-for-q-using-an-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using software to solve the problem allows the use of the Colebrook equation in a straightforward format. The <em>hydraulics</em> package in R is applied to the same problem as above.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="water-flowing-in-pipes-energy-losses.html#cb17-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">darcyweisbach</span>(<span class="at">D=</span><span class="fl">0.5</span>, <span class="at">hf=</span><span class="fl">0.6</span>, <span class="at">L=</span><span class="dv">100</span>, <span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">nu=</span><span class="fl">1.023e-06</span>, <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&#39;SI&#39;</span>))</span>
<span id="cb17-2"><a href="water-flowing-in-pipes-energy-losses.html#cb17-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">format</span>(<span class="fu">as.data.frame</span>(ans), <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">format =</span> <span class="st">&quot;pipe&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Q</th>
<th align="left">V</th>
<th align="left">L</th>
<th align="left">D</th>
<th align="left">hf</th>
<th align="left">f</th>
<th align="left">ks</th>
<th align="left">Re</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0.406</td>
<td align="left">2.07</td>
<td align="left">100</td>
<td align="left">0.5</td>
<td align="left">0.6</td>
<td align="left">0.0133</td>
<td align="left">4.6e-05</td>
<td align="left">1010392</td>
</tr>
</tbody>
</table>
<p>The answer differs from the manual iteration by just over 2%, showing remarkable consistency.</p>
</div>
</div>
<div id="solving-for-pipe-diameter-d-type-3-problems" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Solving for pipe diameter, D (Type 3 problems)<a href="water-flowing-in-pipes-energy-losses.html#solving-for-pipe-diameter-d-type-3-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When D is unknown, neither Re nor relative roughness <span class="math inline">\(\frac{ks}{D}\)</span> are known. Referring to the Moody diagram, Figure <a href="water-flowing-in-pipes-energy-losses.html#fig:moody1">3.1</a>, the difficulty in estimating a value for <em>f</em> (on the left axis) is evident since the positions on either the right axis (<span class="math inline">\(\frac{ks}{D}\)</span>) or x-axis (<em>Re</em>) are known.</p>
<div id="solving-for-d-using-manual-iterations" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Solving for D using manual iterations<a href="water-flowing-in-pipes-energy-losses.html#solving-for-d-using-manual-iterations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Solving for D using manual iterations is done by first rearranging Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-3">(3.9)</a> to allow it to be solved for zero, as in Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-4">(3.10)</a>.
<span class="math display" id="eq:coleb-4">\[\begin{equation}
  -2.221D^2\sqrt{\frac{gDh_f}{L}} \log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{1.784\nu}{D}\sqrt{\frac{L}{gDh_f}}\right)-Q=0
  \tag{3.10}
\end{equation}\]</span></p>
<p>Using this with manual iterations is demonstrated in Example <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-3-1">3.5</a>.</p>
<div class="example">
<p><span id="exm:pipe-3-1" class="example"><strong>Example 3.5  </strong></span>For a similar problem to <a href="water-flowing-in-pipes-energy-losses.html#exm:pipe-2-1">3.4</a> use Q=0.416m<sup>3</sup>/s and solve for the required pipe diameter, D.</p>
</div>
<p>This can be solved manually by guessing values and repeating the calculation in a spreadsheet or with a tool like R.</p>
<p><strong>Iteration 1:</strong> Guess an arbitrary value of D=0.3m. Solve the left side of Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-4">(3.10)</a> to obtain a value of -0.31</p>
<p><strong>Iteration 2:</strong> Guess another value for D=1.0m. The left side of Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-4">(3.10)</a> produces a value for the function of 2.11</p>
<p>The root, when the function equals zero, lies between the two values, so the correct D is between 0.3 and 1.0. Repeated values can home in on a solution. Plotting the results from many trials can help guide toward the solution.
<img src="images/type3_guesses.png" width="258" style="display: block; margin: auto;" />
The root is seen to lie very close to D=0.5 m. Repeated trials can home in on the result.</p>
</div>
<div id="solving-for-d-using-an-equation-solver" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Solving for D using an equation solver<a href="water-flowing-in-pipes-energy-losses.html#solving-for-d-using-an-equation-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An equation solver automatically accomplishes the manual steps of the prior demonstration. The equation from 1.6 can be written as a function that can then be solved for the root, again using <em>R</em> software for the demonstration:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="water-flowing-in-pipes-energy-losses.html#cb18-1" aria-hidden="true" tabindex="-1"></a>q_fcn <span class="ot">&lt;-</span> <span class="cf">function</span>(D, Q, hf, L, ks, nu, g) {</span>
<span id="cb18-2"><a href="water-flowing-in-pipes-energy-losses.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">2.221</span> <span class="sc">*</span> D<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(( g <span class="sc">*</span> D <span class="sc">*</span> hf)<span class="sc">/</span>L) <span class="sc">*</span> <span class="fu">log10</span>((ks<span class="sc">/</span>D)<span class="sc">/</span><span class="fl">3.7</span> <span class="sc">+</span> (<span class="fl">1.784</span> <span class="sc">*</span> nu<span class="sc">/</span>D) <span class="sc">*</span> <span class="fu">sqrt</span>(L<span class="sc">/</span>(g <span class="sc">*</span> D <span class="sc">*</span> hf))) <span class="sc">-</span> Q</span>
<span id="cb18-3"><a href="water-flowing-in-pipes-energy-losses.html#cb18-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <em>uniroot</em> function can solve the equation in R (or use a comparable approach in other software) for a reasonable range of D values</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="water-flowing-in-pipes-energy-losses.html#cb19-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(q_fcn, <span class="at">interval=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">4.0</span>),<span class="at">Q=</span><span class="fl">0.416</span>, <span class="at">hf=</span><span class="fl">0.6</span>, <span class="at">L=</span><span class="dv">100</span>, <span class="at">ks=</span><span class="fl">0.000046</span>, <span class="at">nu=</span><span class="fl">1.023053e-06</span>, <span class="at">g=</span><span class="fl">9.81</span>)<span class="sc">$</span>root</span>
<span id="cb19-2"><a href="water-flowing-in-pipes-energy-losses.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;D = %.3f m</span><span class="sc">\n</span><span class="st">&quot;</span>, ans))</span>
<span id="cb19-3"><a href="water-flowing-in-pipes-energy-losses.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D = 0.501 m</span></span></code></pre></div>
</div>
</div>
<div id="parallel-pipes-solving-a-system-of-equations" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Parallel pipes: solving a system of equations<a href="water-flowing-in-pipes-energy-losses.html#parallel-pipes-solving-a-system-of-equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the examples above the challenge was often to solve a single implicit equation. The manual iteration approach can work to solve two equations, but as the number of equations increases, especially when using implicit equations, using an equation solver is needed.</p>
<p>For the case of a simple pipe loop manual iterations are impractical. for this reason often fixed values of <em>f</em> are assumed, or an empirical energy loss equation is used. However, a single loop, identical to a parallel pipe problem, can be used to demonstrate how systems of equations can be solved simultaneously for systems of pipes.</p>
<p>Example <a href="water-flowing-in-pipes-energy-losses.html#exm:loop-1">3.6</a> demonstrates the process of assembling the equations for a solver for a parallel pipe problem.</p>
<div class="example">
<p><span id="exm:loop-1" class="example"><strong>Example 3.6  </strong></span>Two pipes carry a flow of Q=0.5 m<sup>3</sup>/s, as depicted in Figure <a href="water-flowing-in-pipes-energy-losses.html#fig:paral-pipe">3.2</a></p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:paral-pipe"></span>
<img src="images/pipe_loop.png" alt="Parallel Pipe Example" width="50%" />
<p class="caption">
Figure 3.2: Parallel Pipe Example
</p>
</div>
<p>The fundamental equations needed are the Darcy-Weisbach equation, the Colebrook equation, and continuity (conservation of mass). For the illustrated system, this means:</p>
<ul>
<li>The flows through each pipe must add to the total flow</li>
<li>The head loss through Pipe 1 must equal that of Pipe 2</li>
</ul>
<p>This could be set up as a system of anywhere from 2 to 10 equations to solve simultaneously. In this example four equations are used:
<span class="math display" id="eq:loopeq1">\[\begin{equation}
  Q_1+Q_2-Q_{total}=V_1\frac{\pi}{4}D_1^2+V_2\frac{\pi}{4}D_2^2-0.5m^3/s=0
  \tag{3.11}
\end{equation}\]</span>
and
<span class="math display" id="eq:loopeq2">\[\begin{equation}
  Qh_{f1}-h_{f2} = \frac{f_1L_1}{D_1}\frac{V_1^2}{2g} -\frac{f_2L_2}{D_2}\frac{V_2^2}{2g}=0
  \tag{3.12}
\end{equation}\]</span></p>
<p>The other two equations are the Colebrook equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-2">(3.8)</a> for solving for the friction factor for each pipe.</p>
<p>These four equations can be solved simultaneously using an equation solver, such as the <em>fsolve</em> function in the <em>R</em> package <em>pracma</em>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="water-flowing-in-pipes-energy-losses.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assign known inputs - SI units</span></span>
<span id="cb20-2"><a href="water-flowing-in-pipes-energy-losses.html#cb20-2" aria-hidden="true" tabindex="-1"></a>Qsum <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb20-3"><a href="water-flowing-in-pipes-energy-losses.html#cb20-3" aria-hidden="true" tabindex="-1"></a>D1 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb20-4"><a href="water-flowing-in-pipes-energy-losses.html#cb20-4" aria-hidden="true" tabindex="-1"></a>D2 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb20-5"><a href="water-flowing-in-pipes-energy-losses.html#cb20-5" aria-hidden="true" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb20-6"><a href="water-flowing-in-pipes-energy-losses.html#cb20-6" aria-hidden="true" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb20-7"><a href="water-flowing-in-pipes-energy-losses.html#cb20-7" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="fl">0.000025</span></span>
<span id="cb20-8"><a href="water-flowing-in-pipes-energy-losses.html#cb20-8" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fl">9.81</span></span>
<span id="cb20-9"><a href="water-flowing-in-pipes-energy-losses.html#cb20-9" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">kvisc</span>(<span class="at">T=</span><span class="dv">100</span>, <span class="at">units=</span><span class="st">&#39;SI&#39;</span>)</span>
<span id="cb20-10"><a href="water-flowing-in-pipes-energy-losses.html#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="water-flowing-in-pipes-energy-losses.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Set up the function that sets up 4 unknowns (x) and 4 equations (y)</span></span>
<span id="cb20-12"><a href="water-flowing-in-pipes-energy-losses.html#cb20-12" aria-hidden="true" tabindex="-1"></a>F_trial <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb20-13"><a href="water-flowing-in-pipes-energy-losses.html#cb20-13" aria-hidden="true" tabindex="-1"></a>  V1 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb20-14"><a href="water-flowing-in-pipes-energy-losses.html#cb20-14" aria-hidden="true" tabindex="-1"></a>  V2 <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb20-15"><a href="water-flowing-in-pipes-energy-losses.html#cb20-15" aria-hidden="true" tabindex="-1"></a>  f1 <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb20-16"><a href="water-flowing-in-pipes-energy-losses.html#cb20-16" aria-hidden="true" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb20-17"><a href="water-flowing-in-pipes-energy-losses.html#cb20-17" aria-hidden="true" tabindex="-1"></a>  Re1 <span class="ot">&lt;-</span> V1<span class="sc">*</span>D1<span class="sc">/</span>nu</span>
<span id="cb20-18"><a href="water-flowing-in-pipes-energy-losses.html#cb20-18" aria-hidden="true" tabindex="-1"></a>  Re2 <span class="ot">&lt;-</span> V2<span class="sc">*</span>D2<span class="sc">/</span>nu</span>
<span id="cb20-19"><a href="water-flowing-in-pipes-energy-losses.html#cb20-19" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb20-20"><a href="water-flowing-in-pipes-energy-losses.html#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Continuity - flows in each branch must add to total</span></span>
<span id="cb20-21"><a href="water-flowing-in-pipes-energy-losses.html#cb20-21" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> V1<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>D1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> V2<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>D2<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> Qsum</span>
<span id="cb20-22"><a href="water-flowing-in-pipes-energy-losses.html#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Darcy-Weisbach equation for head loss - must be equal in each branch</span></span>
<span id="cb20-23"><a href="water-flowing-in-pipes-energy-losses.html#cb20-23" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">2</span>] <span class="ot">&lt;-</span> f1<span class="sc">*</span>L1<span class="sc">*</span>V1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(D1<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>g) <span class="sc">-</span> f2<span class="sc">*</span>L2<span class="sc">*</span>V2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(D2<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>g)</span>
<span id="cb20-24"><a href="water-flowing-in-pipes-energy-losses.html#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Colebrook equation for friction factors</span></span>
<span id="cb20-25"><a href="water-flowing-in-pipes-energy-losses.html#cb20-25" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.0</span><span class="sc">*</span><span class="fu">log10</span>((ks<span class="sc">/</span>D1)<span class="sc">/</span><span class="fl">3.7</span> <span class="sc">+</span> <span class="fl">2.51</span><span class="sc">/</span>(Re1<span class="sc">*</span>(f1<span class="sc">^</span><span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(f1<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb20-26"><a href="water-flowing-in-pipes-energy-losses.html#cb20-26" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.0</span><span class="sc">*</span><span class="fu">log10</span>((ks<span class="sc">/</span>D2)<span class="sc">/</span><span class="fl">3.7</span> <span class="sc">+</span> <span class="fl">2.51</span><span class="sc">/</span>(Re2<span class="sc">*</span>(f2<span class="sc">^</span><span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(f2<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb20-27"><a href="water-flowing-in-pipes-energy-losses.html#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb20-28"><a href="water-flowing-in-pipes-energy-losses.html#cb20-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-29"><a href="water-flowing-in-pipes-energy-losses.html#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="water-flowing-in-pipes-energy-losses.html#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co">#provide initial guesses for unknowns and run the fsolve command</span></span>
<span id="cb20-31"><a href="water-flowing-in-pipes-energy-losses.html#cb20-31" aria-hidden="true" tabindex="-1"></a>xstart <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>)</span>
<span id="cb20-32"><a href="water-flowing-in-pipes-energy-losses.html#cb20-32" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> pracma<span class="sc">::</span><span class="fu">fsolve</span>(F_trial, xstart)</span>
<span id="cb20-33"><a href="water-flowing-in-pipes-energy-losses.html#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="water-flowing-in-pipes-energy-losses.html#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare some results to print</span></span>
<span id="cb20-35"><a href="water-flowing-in-pipes-energy-losses.html#cb20-35" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> z<span class="sc">$</span>x[<span class="dv">1</span>]<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>D1<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-36"><a href="water-flowing-in-pipes-energy-losses.html#cb20-36" aria-hidden="true" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> z<span class="sc">$</span>x[<span class="dv">2</span>]<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>D2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-37"><a href="water-flowing-in-pipes-energy-losses.html#cb20-37" aria-hidden="true" tabindex="-1"></a>hf1 <span class="ot">&lt;-</span> z<span class="sc">$</span>x[<span class="dv">3</span>]<span class="sc">*</span>L1<span class="sc">*</span>z<span class="sc">$</span>x[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(D1<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>g)</span>
<span id="cb20-38"><a href="water-flowing-in-pipes-energy-losses.html#cb20-38" aria-hidden="true" tabindex="-1"></a>hf2 <span class="ot">&lt;-</span> z<span class="sc">$</span>x[<span class="dv">4</span>]<span class="sc">*</span>L2<span class="sc">*</span>z<span class="sc">$</span>x[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(D2<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>g)</span>
<span id="cb20-39"><a href="water-flowing-in-pipes-energy-losses.html#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Q1=%.2f, Q2=%.2f, V1=%.1f, V2=%.1f, hf1=%.1f, hf2=%.1f, f1=%.3f, f2=%.3f</span><span class="sc">\n</span><span class="st">&quot;</span>, Q1,Q2,z<span class="sc">$</span>x[<span class="dv">1</span>],z<span class="sc">$</span>x[<span class="dv">2</span>],hf1,hf2,z<span class="sc">$</span>x[<span class="dv">3</span>],z<span class="sc">$</span>x[<span class="dv">4</span>]))</span>
<span id="cb20-40"><a href="water-flowing-in-pipes-energy-losses.html#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q1=0.15, Q2=0.35, V1=4.8, V2=5.0, hf1=30.0, hf2=30.0, f1=0.013, f2=0.012</span></span></code></pre></div>
<p>If the <em>fsolve</em> command fails, a simple solution is sometimes to revise your initial guesses and try again. There are other solvers in <em>R</em> and every other scripting language that can be similarly implemented.</p>
<p>If the simplification were applied for fixed <em>f</em> values, then Equations <a href="water-flowing-in-pipes-energy-losses.html#eq:loopeq1">(3.11)</a> and <a href="water-flowing-in-pipes-energy-losses.html#eq:loopeq2">(3.12)</a> can be solved simultaneously for V<sub>1</sub> and V<sub>2</sub>.</p>
</div>
<div id="simple-pipe-networks-the-hardy-cross-method" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Simple pipe networks: the Hardy-Cross method<a href="water-flowing-in-pipes-energy-losses.html#simple-pipe-networks-the-hardy-cross-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For water pipe networks containing multiple loops, manually setting up systems of equations is impractical. In addition, hand calculations always assume fixed <em>f</em> values or use an empirical friction loss equation to simplify calculations.</p>
<p>A typical method to solve for the flow in each pipe segment in a small network uses the Hardy-Cross method. This consists of setting up an initial guess of flow (magnitude and direction) for each pipe segment, ensuring conservation of mass is preserved at each node (or vertex) in the network. Then calculations are performed for each loop, ensuring energy is conserved.</p>
<p>When using the Darcy-Weisbach equation, Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:d-w1">(3.3)</a>, for friction loss, the head loss in each pipe segment is usually expressed in a condensed form as <span class="math inline">\({h_f = KQ^{2}}\)</span> where <em>K</em> is defined as in Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:hceq1">(3.13)</a>.
<span class="math display" id="eq:hceq1">\[\begin{equation}
  K = \frac{8fL}{\pi^{2}gD^{5}}
  \tag{3.13}
\end{equation}\]</span></p>
<p>When doing calculations by hand fixed <em>f</em> values are assumed, but when using a computational tool like <em>R</em> any of the methods for estimating <em>f</em> and h<sub>f</sub> may be applied.</p>
<p>The Hardy-Cross method begins by assuming flows in each segment of a loop. These initial flows are then adjusted in a series of iterations. The flow adjustment in each loop is calculated at each iteration in Equation Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:hceq2">(3.14)</a>.
<span class="math display" id="eq:hceq2">\[\begin{equation}
  \Delta{Q_i} = -\frac{\sum_{j=1}^{p_i} K_{ij}Q_j|Q_j|}{\sum_{j=1}^{p_i} 2K_{ij}Q_j^2}
  \tag{3.14}
\end{equation}\]</span></p>
<p>For calculations for small systems with two or three loops can be done manually with fixed <em>f</em> and <em>K</em> values. Using the <em>hydraulics</em> R package to solve a small pipe network is demonstrated in Example <a href="water-flowing-in-pipes-energy-losses.html#exm:hcross-1">3.7</a>.</p>
<div class="example">
<p><span id="exm:hcross-1" class="example"><strong>Example 3.7  </strong></span>Find the flows in each pipe in teh system shown in Figure <a href="water-flowing-in-pipes-energy-losses.html#fig:hc-1">3.3</a>. Input consists of pipe characteristics, pipe order and initial flows for each loop, as shown non the diagram.</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:hc-1"></span>
<img src="images/hardycross_system.png" alt="A sample pipe network with pipe numbers indicated in black" width="75%" />
<p class="caption">
Figure 3.3: A sample pipe network with pipe numbers indicated in black
</p>
</div>
<p>Input for this system, assuming fixed <em>f</em> values, would look like the following. (If fixed <em>K</em> values are provided, f, L and D are not needed). These <em>f</em> values were estimated using <span class="math inline">\(ks=0.00025 m\)</span> in the form of the Colebrook equation for fully rough flows, Equation <a href="water-flowing-in-pipes-energy-losses.html#eq:coleb-rough">(3.5)</a>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="water-flowing-in-pipes-energy-losses.html#cb21-1" aria-hidden="true" tabindex="-1"></a>dfpipes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-2"><a href="water-flowing-in-pipes-energy-losses.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>),                                <span class="co">#pipe ID</span></span>
<span id="cb21-3"><a href="water-flowing-in-pipes-energy-losses.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">D =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span>),         <span class="co">#diameter in m</span></span>
<span id="cb21-4"><a href="water-flowing-in-pipes-energy-losses.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">L =</span> <span class="fu">c</span>(<span class="dv">250</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">125</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">125</span>),              <span class="co">#length in m</span></span>
<span id="cb21-5"><a href="water-flowing-in-pipes-energy-losses.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> <span class="fu">c</span>(.<span class="dv">01879</span>,.<span class="dv">02075</span>,.<span class="dv">02075</span>,.<span class="dv">02075</span>,.<span class="dv">02075</span>,.<span class="dv">02233</span>,.<span class="dv">01964</span>,.<span class="dv">02233</span>,.<span class="dv">02233</span>,.<span class="dv">01964</span>)</span>
<span id="cb21-6"><a href="water-flowing-in-pipes-energy-losses.html#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="water-flowing-in-pipes-energy-losses.html#cb21-7" aria-hidden="true" tabindex="-1"></a>loops <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb21-8"><a href="water-flowing-in-pipes-energy-losses.html#cb21-8" aria-hidden="true" tabindex="-1"></a>Qs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">040</span>,.<span class="dv">040</span>,.<span class="dv">02</span>,<span class="sc">-</span>.<span class="dv">02</span>,<span class="sc">-</span>.<span class="dv">04</span>),<span class="fu">c</span>(.<span class="dv">02</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span>.<span class="dv">02</span>),<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">02</span>,.<span class="dv">02</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span></code></pre></div>
<p>Running the <em>hardycross</em> function and looking at the output after three iterations (defined by <em>n_iter</em>):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="water-flowing-in-pipes-energy-losses.html#cb22-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">hardycross</span>(<span class="at">dfpipes =</span> dfpipes, <span class="at">loops =</span> loops, <span class="at">Qs =</span> Qs, <span class="at">n_iter =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;SI&quot;</span>)</span>
<span id="cb22-2"><a href="water-flowing-in-pipes-energy-losses.html#cb22-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ans<span class="sc">$</span>dfloops, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">format =</span> <span class="st">&quot;pipe&quot;</span>, <span class="at">padding=</span><span class="dv">0</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">loop</th>
<th align="right">pipe</th>
<th align="right">flow</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.0383</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.0383</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">0.0232</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-0.0258</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">-0.0417</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">0.0258</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0.0090</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">0.0041</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">-0.0159</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">-0.0232</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">9</td>
<td align="right">0.0151</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">10</td>
<td align="right">-0.0049</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">6</td>
<td align="right">-0.0090</td>
</tr>
</tbody>
</table>
<p>The output pipe data frame has added columns, including the flow (where direction is that for the first loop containing the segment).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="water-flowing-in-pipes-energy-losses.html#cb23-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ans<span class="sc">$</span>dfpipes, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">format =</span> <span class="st">&quot;pipe&quot;</span>, <span class="at">padding=</span><span class="dv">0</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="right">D</th>
<th align="right">L</th>
<th align="right">f</th>
<th align="right">Q</th>
<th align="right">K</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.30</td>
<td align="right">250</td>
<td align="right">0.0188</td>
<td align="right">0.0383</td>
<td align="right">159.7828</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">0.0208</td>
<td align="right">0.0383</td>
<td align="right">535.9666</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">0.0208</td>
<td align="right">0.0232</td>
<td align="right">669.9582</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">0.0208</td>
<td align="right">-0.0258</td>
<td align="right">669.9582</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">0.0208</td>
<td align="right">-0.0417</td>
<td align="right">535.9666</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">0.0223</td>
<td align="right">0.0090</td>
<td align="right">2430.5356</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">0.0196</td>
<td align="right">0.0041</td>
<td align="right">207.7883</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">0.0223</td>
<td align="right">-0.0159</td>
<td align="right">2430.5356</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">0.0223</td>
<td align="right">0.0151</td>
<td align="right">2430.5356</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">0.0196</td>
<td align="right">-0.0049</td>
<td align="right">207.7883</td>
</tr>
</tbody>
</table>
<p>While the Hardy-Cross method is often used with fixed <em>f</em> (or <em>K</em>) values when it is used in exercises performed by hand, the use of the Colebrook equation allows friction losses to vary with Reynolds number. To use this approach the input data must include absolute roughness. Example values are included here:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="water-flowing-in-pipes-energy-losses.html#cb24-1" aria-hidden="true" tabindex="-1"></a>dfpipes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-2"><a href="water-flowing-in-pipes-energy-losses.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>),                         <span class="co">#pipe ID</span></span>
<span id="cb24-3"><a href="water-flowing-in-pipes-energy-losses.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">D =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span>),  <span class="co">#diameter in m</span></span>
<span id="cb24-4"><a href="water-flowing-in-pipes-energy-losses.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">L =</span> <span class="fu">c</span>(<span class="dv">250</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">125</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">125</span>),       <span class="co">#length in m</span></span>
<span id="cb24-5"><a href="water-flowing-in-pipes-energy-losses.html#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ks =</span> <span class="fu">rep</span>(<span class="fl">0.00025</span>,<span class="dv">10</span>)                                  <span class="co">#absolute roughness, m</span></span>
<span id="cb24-6"><a href="water-flowing-in-pipes-energy-losses.html#cb24-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-7"><a href="water-flowing-in-pipes-energy-losses.html#cb24-7" aria-hidden="true" tabindex="-1"></a>loops <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb24-8"><a href="water-flowing-in-pipes-energy-losses.html#cb24-8" aria-hidden="true" tabindex="-1"></a>Qs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(.<span class="dv">040</span>,.<span class="dv">040</span>,.<span class="dv">02</span>,<span class="sc">-</span>.<span class="dv">02</span>,<span class="sc">-</span>.<span class="dv">04</span>),<span class="fu">c</span>(.<span class="dv">02</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span>.<span class="dv">02</span>),<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">02</span>,.<span class="dv">02</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span></code></pre></div>
<p>The effect of allowing the calculation of <em>f</em> to be (correctly) dependent on velocity (via the Reynolds number) can be seen, though the effect on final flow values is small.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="water-flowing-in-pipes-energy-losses.html#cb25-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> hydraulics<span class="sc">::</span><span class="fu">hardycross</span>(<span class="at">dfpipes =</span> dfpipes, <span class="at">loops =</span> loops, <span class="at">Qs =</span> Qs, <span class="at">n_iter =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;SI&quot;</span>)</span>
<span id="cb25-2"><a href="water-flowing-in-pipes-energy-losses.html#cb25-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ans<span class="sc">$</span>dfpipes, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">format =</span> <span class="st">&quot;pipe&quot;</span>, <span class="at">padding=</span><span class="dv">0</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="right">D</th>
<th align="right">L</th>
<th align="right">ks</th>
<th align="right">Q</th>
<th align="right">f</th>
<th align="right">K</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.30</td>
<td align="right">250</td>
<td align="right">3e-04</td>
<td align="right">0.0382</td>
<td align="right">0.0207</td>
<td align="right">176.1877</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">0.0382</td>
<td align="right">0.0218</td>
<td align="right">562.9732</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">0.0230</td>
<td align="right">0.0224</td>
<td align="right">723.1119</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">-0.0258</td>
<td align="right">0.0222</td>
<td align="right">718.1439</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">-0.0418</td>
<td align="right">0.0217</td>
<td align="right">560.8321</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">0.0088</td>
<td align="right">0.0248</td>
<td align="right">2700.4710</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">0.0040</td>
<td align="right">0.0280</td>
<td align="right">296.3990</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">-0.0160</td>
<td align="right">0.0238</td>
<td align="right">2590.2795</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">0.0152</td>
<td align="right">0.0239</td>
<td align="right">2598.5553</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">-0.0048</td>
<td align="right">0.0270</td>
<td align="right">285.4983</td>
</tr>
</tbody>
</table>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="properties-of-water.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="flow-in-open-channels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
